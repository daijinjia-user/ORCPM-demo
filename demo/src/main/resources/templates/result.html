<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<script src="//unpkg.com/layui@2.7.6/dist/layui.js"></script>
<script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous" language="JavaScript" type="text/javascript"></script>
<style type="text/css">
body {
    margin: 0;
    background-size: cover;
}

html,
body {
    width: 100%;
    height: auto;
}
/* 覆盖层的样式 */
#overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* 半透明背景色 */
    z-index: 999;
}
/* 加载框的样式 */
#loading {
    display: none;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background-color: #fff;
    padding: 20px;
    border-radius: 5px;
    z-index: 1000; /* 比覆盖层更高的层级 */
    color: #000;
}
#header {
    background: #020258;
    color: white;
    position: sticky;
    height: 80px;
    top: 0;
    width: 100%;
    margin-top: -30px;
    line-height: 80px;
}

#uploadbtn button{
    color: white;
}

footer {
    background: #020258;
    position:absolute;
    bottom:0;
    width:100%;
    height:100px;
}

.box {
    text-align: center;
    padding: 5px;
}

.box div {
    display: inline-block;
    line-height: 50px;
    font-size: 16px;
}

.box form input {
    border-radius: 5px;
    border-width: 2px;
    border-style: solid;
}

#radioForm{
    line-height: 30px;
    font-weight: 600;
    font-style: italic;
}


#nine-squaregrid {
    width: 610px;
    height: 420px;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
    background-color: rgb(228, 226, 226);
}

#nine-squaregrid>img {
    width: 200Px;
    height: 140px;
    object-fit: contain;
}

/*居中格式*/
#centers {
    text-align: center;
    font-size: 30px;
}
#write-left{
    transform: rotate(270deg);
}
.file {
    position: relative;
    background: #D0EEFF;
    border: 1px solid #99D3F5;
    border-radius: 4px;
    padding: 4px 12px;
    overflow: hidden;
    color: #1E88C7;
    text-decoration: none;
    text-indent: 0;
    line-height: 20px;
}

.file input {
    position: absolute;
    font-size: 100px;
    right: 0;
    top: 0;
    opacity: 0;
}

.file:hover {
    background: #AADFFD;
    border-color: #78C3F3;
    color: #004974;
    text-decoration: none;
}


</style>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>The Online Decision Support System Based On Regional Co-location Pattern</title>

<body>
<div id="header">
    <p id="centers">Welcome to the online demonstration system for RCPM</p>
</div>
<div id="overlay"></div>
<div id="loading">Loading...</div>
<div style="margin: auto;width: 80%;border: 3px solid black;background: #e4f1fe">
    <div class="box" style="border-top-left-radius:6px;border-top-right-radius:6px;margin-top: 25px;">
        <div style="margin-left: 20px;">
            <div style="height: 400px;width: 300px;overflow:auto;text-align: left;">
                <form id="mainForm" action="/regionPartition">
                    <br>
                    <span style="margin-bottom: 30px;color: #1E88C7;font-size: 20px;font-weight: 600;">
                    Please enter core feature
                </span>
                    <input style="width: 80px;height: 40px;border-radius: 10px;font-size: 20px;text-align: center;"
                           name="coreFeature" th:value="${coreFeature_j}">
                    <br>
                    <span style="margin-bottom: 30px;color: #1E88C7;font-size: 20px;font-weight: 600;">
                        Core nearest affiliation num
                    </span>
                    <input th:value="${coreNum_j != null ? coreNum_j : '1'}" name="coreNum"
                           style="width: 80px;height: 40px;border-radius: 10px;font-size: 20px;text-align: center;">
                    <br>
                    <button style="border-radius: 7px;background-color: #a8e4d7;font-size: 24px;margin-top: 20px;"
                            onclick="subFile()">Submit
                    </button>
                </form>
            </div>
            <div style="height: 400px;width: 400px;overflow:auto;text-align: center;">
                    <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Distribution of core instances
                    </span>
                <img src="/image/coreInstances.png" alt="文件图"
                     style="max-width:380px;max-height: 380px;border: 3px solid black;">
            </div>
        </div>
        <div style="height: 400px;width: 2px;background-color: #1E88C7;padding-top: 64px;margin-top: -40px;margin-bottom: -27px;margin-left: 50px"></div>
        <div style="margin-right: 20px;margin-left: 50px;">
            <div style="height: 400px;width: 400px;overflow:auto;text-align: center;">
                    <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Regional partitioning result
                    </span>
                <img id="regionPartitionImage" src="/image/coreRegion.png" alt="文件图"
                     style="max-width:380px;max-height: 380px;border: 3px solid black;">
            </div>
            <div style="height: 380px;width: 150px;overflow:auto;text-align: center;background-color: white;border: 3px solid black;margin-left: 20px;border-radius: 10px;margin-bottom: 20px">
                <span style="color: #1E88C7;font-weight: 600;font-size: 20px;font-style: italic;">pd</span>
                <hr style="margin-top: 5px;border: 2px solid black;">
                <form id="radioForm">
                    <input type="radio" id="option1" name="group1" value="1.0" th:checked="${pd_j == 1.0}">
                    <label for="option1">1.0*pd</label><br>
                    <input type="radio" id="option2" name="group1" value="1.1" th:checked="${pd_j == 1.1}">
                    <label for="option2">1.1*pd</label><br>
                    <input type="radio" id="option3" name="group1" value="1.2" th:checked="${pd_j == 1.2}">
                    <label for="option3">1.2*pd</label><br>
                    <input type="radio" id="option4" name="group1" value="1.3" th:checked="${pd_j == 1.3}">
                    <label for="option3">1.3*pd</label><br>
                    <input type="radio" id="option5" name="group1" value="1.4" th:checked="${pd_j == 1.4}">
                    <label for="option3">1.4*pd</label><br>
                    <input type="radio" id="option6" name="group1" value="1.5" th:checked="${pd_j == 1.5}">
                    <label for="option3">1.5*pd</label><br>
                    <input type="radio" id="option7" name="group1" value="1.6" th:checked="${pd_j == 1.6}">
                    <label for="option3">1.6*pd</label><br>
                    <input type="radio" id="option8" name="group1" value="1.7" th:checked="${pd_j == 1.7}">
                    <label for="option3">1.7*pd</label><br>
                    <input type="radio" id="option9" name="group1" value="1.8" th:checked="${pd_j == 1.8}">
                    <label for="option3">1.8*pd</label><br>
                    <input type="radio" id="option10" name="group1" value="1.9"th:checked="${pd_j == 1.9}">
                    <label for="option3">1.9*pd</label><br>
                </form>
            </div>
        </div>
        <hr style="margin-top: 5px;border: 2px solid #1E88C7;">
    </div>
    <div class="box" style="border-top-left-radius:6px;border-top-right-radius:6px;">
        <div style="margin-right: 4%;">
            <div style="height: 400px;width: 400px;overflow:auto;text-align: center;">
                <form action="/submitinfo">
               <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                   Please enter parameters
                </span>
                    <br>
                    <span style="margin-bottom: 30px;font-weight: 600;font-size: 20px;font-style: italic;">
                        Min_prev
                    </span>
                    <input th:value="${min_prev_j != null ? min_prev_j : ''}" name="min_prev"
                           style="width: 60px;height: 30px;border-radius: 10px;font-size: 20px;margin-left: 10px;text-align: center;">
                    <button id="submitbtn"
                            style="border-radius: 7px;background-color: #a8e4d7;font-size: 24px;margin-top: 20px;margin-left: 23%" onclick="subMin_prev()">
                        Submit
                    </button>
                </form>
                <div class="layui-card-body"
                     style="width:350px;height: 150px;border: 3px solid black; overflow-y: auto;background-color: white;">
                    <ul style="padding-left: 10px;height:130px;text-align: left;">
                        <ol style="font-size: 16px;font-weight: bold" th:each="localandPI:${localandPIs}"
                            th:text="${localandPI.key} + '  |  ' + ${localandPI.value} ">BC | 0
                        </ol>
                    </ul>
                </div>
                <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Mining results display
                    </span>
            </div>
        </div>
        <div style="height: 400px;width: 2px;background-color: #1E88C7;padding-top: 48px;margin-top: -40px;margin-bottom: -27px;"></div>
        <div style="margin-right: 20px;margin-left: 20px;">
            <div style="height: 400px;width: 450px;overflow:auto;text-align: center;">
                    <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Please select pattern
                    </span>
                <!--                <select id="patterns" name="patterns"-->
                <!--                        style="width: 100px;height: 40px;font-size: 20px;text-align: center;border-radius: 7px;">-->
                <!--                    <option value="{J,A,C}">{J,A,C}</option>-->
                <!--                    <option value="{J,B,C}">{J,B,C}</option>-->
                <!--                    <option value="{J,C}">{J,C}</option>-->
                <!--                    <option value="{A,C}">{A,C}</option>-->
                <!--                </select>-->
                <select name="partten" lay-verify="" lay-search=""
                        style="width: 100px;height: 40px;font-size: 20px;text-align: center;border-radius: 7px;"
                        onchange="changePattern(this.value)">
                    <option>Please select a pattern</option>
                    <section th:each="localandPI:${localandPIs}">
                        <option th:value="${localandPI.key}" th:text="${localandPI.key}">BC</option>
                    </section>
                </select>
                <img id="patternImg" th:src="@{picture/inupload.webp}" src="/image/inupload.webp" alt="文件图"
                     style="width: 85%;max-height: 67%;border: 3px solid black;">
                <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Pattern regions display
                    </span>
            </div>
        </div>
        <div style="height: 400px;width: 2px;background-color: #1E88C7;padding-top: 48px;margin-top: -40px;margin-bottom: -27px;"></div>
        <div style="margin-left: 4%;">
            <div style="height: 400px;width: 450px;overflow:auto;text-align: center;">
                    <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Please select region
                    </span>
                <select name="patternRegion" lay-verify="" lay-search=""
                        style="width: 100px;height: 40px;font-size: 20px;text-align: center;border-radius: 7px;"
                        onchange="changeRegion(this.value)">
                    <option>Please select region</option>
                    <option value="Region1">Region1</option>
                    <option value="Region2">Region2</option>
                </select>
                <img id="regionImg" src="/image/inupload.webp" alt="文件图"
                     style="width: 85%;max-height: 67%;border: 3px solid black;">
                <span style="margin-bottom: 30px;color: #1E88C7;font-weight: 600;font-size: 20px;">
                        Regional detailed distribution display
                    </span>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" th:inline="javascript">
function changePattern(targetValue) {
        var parames = 'file='+targetValue;
        if (targetValue != 'Please select a pattern'){
            $("#loading").show();
            $("#overlay").show();
            $.ajax({
                //服务器路径
                url:"http://localhost:8080/filetpattern",
                //提交服务器的数据
                data:parames,
                //响应失败的回调函数
                error:function(){
                    alert("响应失败");
                    $("#loading").hide();
                    $("#overlay").hide();
                },
                //响应成功的回调函数
                success:function(data){
                    alert("Success!");
                    let dataList = JSON.parse(data);
                    $("#patternImg").attr("src","http://localhost:8080/image/patternRegion/localRegions"+targetValue+".png");

                    // 清空原有的 <option> 元素
                    var $select = $("select[name='patternRegion']");
                    $select.empty();

                    // 添加新的 <option> 元素
                    $select.append(new Option('Please select region', ''));

                    for (var i = 0; i < dataList.length; i++) {
                        $select.append(new Option("Region "+dataList[i], "Region "+dataList[i]));
                    }
                    $("#regionImg").attr("src", "http://localhost:8080/image/inupload.webp");
                    $("#loading").hide();
                    $("#overlay").hide();
                },
                //设置接收的响应数据格式
                dataType:"text",
                //设置请求方式
                type:"POST"
            });
        }else {
            alert('Please select at least one option');
            $("#patternImg").attr("src","http://localhost:8080/image/inupload.webp");
        }
    }
function changeRegion(targetValue) {
        console.log(targetValue)
        $("#regionImg").attr("src","http://localhost:8080/image/region/"+targetValue+".png");
    }
function subMin_prev(){
    // 显示加载框和覆盖层
    $("#loading").show();
    $("#overlay").show();

    // 在表单提交前，显示加载框和覆盖层
    $("#mainForm").on("submit", function() {
        $("#loading").show();
        $("#overlay").show();
    });
}
function subFile() {
    // 显示加载框和覆盖层
    $("#loading").show();
    $("#overlay").show();

    // 在表单提交前，显示加载框和覆盖层
    $("#mainForm").on("submit", function() {
        $("#loading").show();
        $("#overlay").show();
    });
    // 获取第二个表单中被选中的单选按钮的值
    const radioForm = document.getElementById('radioForm');
    const selectedRadio = radioForm.querySelector('input[name="group1"]:checked').value;

    // 创建一个隐藏的输入字段
    const hiddenInput = document.createElement('input');
    hiddenInput.type = 'hidden';
    hiddenInput.name = 'pd';
    hiddenInput.value = selectedRadio;

    // 将隐藏输入字段附加到第一个表单
    const mainForm = document.getElementById('mainForm');
    mainForm.appendChild(hiddenInput);

    // 提交第一个表单
    mainForm.submit();
}
<!--document.getElementById('radioForm').addEventListener('change', function(event) {-->
<!--            console.log("yess");-->
<!--            var selectedValue = document.querySelector('input[name="group1"]:checked').value;-->
<!--            var imgElement = document.getElementById('regionPartitionImage');-->
<!--            imgElement.src = "/image/partitionRegion" + selectedValue.replace('.', '') + ".png";-->
<!--        });-->


</script>

</html>
